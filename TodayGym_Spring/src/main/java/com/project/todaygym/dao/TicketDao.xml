<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project.todaygym.dao.TicketDao">
	
	<!-- 회원권 발급하기 -->
	<insert id="issueClass"
		parameterType="com.project.todaygym.dto.TicketDto"
		useGeneratedKeys="true" keyProperty="t_no">

		<selectKey keyProperty="t_no" resultType="Integer"
			order="BEFORE">
			SELECT TICKET_SEQ.NEXTVAL FROM DUAL
		</selectKey>
		INSERT INTO T
		VALUES (${t_no}, #{m_id}, #{p_code}, #{o_code}, SYSDATE, DEFAULT)
		
	</insert>
	
	<!-- 회원권 발급하기 -->
	<select id="myClassListSelect" parameterType="String" resultType="com.project.todaygym.dto.MyClassDto">
		
		SELECT C.P_IMG, C.P_CATE, C.P_SUBCATE, D.O_MONTH, A.T_ISSUEDATE, A.T_USE
		FROM TICKET_TB A, MEMBER_TB B, PRODUCT_TB C, OPTION_TB D
		WHERE A.M_ID = B.M_ID AND A.P_CODE = C.P_CODE AND A.O_CODE = D.O_CODE
		AND A.M_ID = #{getId}
		ORDER BY A.T_ISSUEDATE DESC
		
	</select>

</mapper>